---
# Simple test workflow template to verify Argo Workflows is working
apiVersion: argoproj.io/v1alpha1
kind: WorkflowTemplate
metadata:
  name: test-argo-workflows-template
  namespace: argocd
  labels:
    app.kubernetes.io/name: argo-workflows-cicd
    app.kubernetes.io/component: test
spec:
  serviceAccountName: workflow-builder
  entrypoint: test-pipeline

  templates:
  - name: test-pipeline
    dag:
      tasks:
      - name: test-step-1
        template: hello-world
      - name: test-step-2
        template: cluster-info
        dependencies: [test-step-1]

  - name: hello-world
    container:
      image: alpine:latest
      command: [echo]
      args: ["üéâ Argo Workflows is working! Pipeline test successful."]

  - name: cluster-info
    container:
      image: alpine:latest
      command: [sh, -c]
      args:
      - |
        echo "üîç Cluster Information:"
        echo "Namespace: argocd"
        echo "Workflow: {{workflow.name}}"
        echo "Timestamp: $(date)"
        echo "‚úÖ Test pipeline completed successfully"